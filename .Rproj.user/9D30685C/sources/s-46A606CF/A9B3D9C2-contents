# generate data 
# 80K rows, 150 cols

data <- as.data.frame(
  matrix(rnorm(8e5*150, mean=5), ncol=150)
)
# centering: subtract off the mean

center_cols <- function(d) {
  # get vector of column means
  means <- apply(d, 2, mean)
  # subtract the mean from the values in each col
  for(i in seq_along(means)) {
    d[,i] <- d[,i] - means[i]
  }
  return(d)
}

# timing code with system.time
system.time({
  result <- center_cols(data)
})

# profile code with profvis
library(profvis)

profvis({
  result <- center_cols(data)
})

#use profiler to check means
means <- apply(data,2,mean)
means <- colMeans(data,mean)
means <- lapply(data,mean)
means <- sapply(data,mean)
means <- vapply(data,mean)
