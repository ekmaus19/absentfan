storyPrint <- function(story, type, title){
  # reads in x and y as if they put quote marks around them
  story <- deparse(substitute(story))
  type <- deparse(substitute(type))
  title <- deparse(substitute(title))

  # report <- readLines(system.file("templateStory.txt", package = "absentfan")) # bring in our template
  report <- readLines("templateStory.txt")
  print("THIS IS THE TEMPLATE--------------------------------")
  print(report)
  report <- gsub("xxxStory", story, report, fixed = TRUE) # change every instance of xxIV replace it
  report <- gsub("xxxType", type, report, fixed = TRUE)
  report <- gsub("xxxTitle", title, report, fixed = TRUE)

  # output template and render
  tf <- tempfile(fileext = ".Rmd")
  to <- tempfile(fileext = ".html")
  writeLines(report, tf)
  library(rmarkdown)
  render(input=tf, output_format="html_document", output_file=to)
  file.show(to)
  # if (browse){
  #   # this will try to make it open up on a browser (doesnt't work on MAC)
  #   file.show(to)
  # } else {
  #   # this is what makes it show up in the R viewer
  #   viewer <- getOption("viewer")
  #   viewer(to)
  # }
  invisible(to) # returns the file path (the object to) but doesnt print it to the console
}
