#' @title Descriptive Statistics by Group
#' @description
#' \code{stats} computes summary statistics by group
#' @param data a data frame
#' @param group a factor
#' @param var numeric variable(s)
#' @export
#' @examples
#' stats(mtcars, "gear", "mpg")
#' stats(mtcars, "gear", c("mpg", "wt"))

stats <- function(data, group, var) {

# check input
if(length(group) > 1) stop("Only one grouping factor is permitted in this function :(")
if(nlevels(factor(data[[group]])) < 1) stop("This grouping factor has no levels")
if(!all(sapply(data[var], is.numeric))) stop("Data must be numeric")

#stats
outstats <- function(x){
  c(mean=mean(x), sd=sd(x), n=length(x))
}

# calculate stats by group
result <- aggregate(x=data[var],
          by=list(data[[group]]),
          FUN=outstats)

# create table and return
names(result)[1] <- group
return(result)

}
