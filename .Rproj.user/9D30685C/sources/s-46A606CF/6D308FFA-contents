data_exp

data_df_exp <- as.data.frame(data_exp)
data_df_exp$LABEL <- data_dtm_labels

save(data_df_exp, file = "data_df.rda", compress = "xz")
#create training and testing datasets
load("data_df.rda")
set.seed(1234)
index <- createDataPartition(data_df_exp$LABEL, p=0.8, list=F)
train <- data_df_exp[index,]
test <- data_df_exp[-index,]

library(caret)

logregbasic <- glm(LABEL ~ ., data=train, family = "binomial")
logregnull <- glm(LABEL ~ 1, data= train, family= "binomial")
save(logregbasic, file="logireg.rda", compress = "xz")
prob <- predict(logregbasic, newdata =test, type="response")
prob2 <- factor(prob>0.5, levels = c(FALSE, TRUE), labels= c(0, 1))

logregmatrix <- confusionMatrix(prob2, test$LABEL, positive = "1")


